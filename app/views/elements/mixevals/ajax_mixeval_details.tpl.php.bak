<!-- elements::ajax_rubric_preview start -->
<form name="frmList" id="frmList">
    <table width="95%" border="0" align="center" cellpadding="4" cellspacing="2">
    	<tr class="tableheader" align=center>
			<td valign="top" colspan="<?=$scale_default?>" width="90%"  align='left'>Section One: &nbsp;Lickert Scales</td>
		<?php
		$descriptor_des = array('1'=>'Lowest','2'=>'','3'=>'Middle','4'=>'','5'=>'Highest');
		
		isset($data['questions'])? $questions = $data['questions'] : $questions = null;
		
		//for loop to display the top header row with LOM comments
		echo "<td width=\"10%\">Scale Weight</td>";
		echo "</tr>";
	  $pos = 1;

		//for loop to display the criteria rows
		for($i=1; $i<=$question_default; $i++){
		  //Get and set Mixeval Question
		  isset($questions[$pos])? $mixevalQuestion = $questions[$pos] : $mixevalQuestion = null;
		  if ($mixevalQuestion !=null) {
		    $questionDescriptors = $mixevalQuestion['descriptors'];
   		  $this->controller->Output->br2nl($mixevalQuestion);
		    $descriptor_des = array();
		    
		    foreach ($questionDescriptors as $row) {
		      $desc = $row['MixevalsQuestionDesc']; 
		      $descriptor_des[$desc['scale_level']] = $desc['descriptor'];
		    }
		  }
		  if (empty($total_mark)) $total_mark = $question_default;

		  
			echo "<tr class=tablecell align=center>";
			echo "<td class=tableheader2 valign=top colspan='".$scale_default."'><table border=0 width=95% cellpadding=2><tr><td width='15%'>Question $pos:</td><td width='85%'>"
				  .$html->areaTag('Mixeval/title'.$pos, '',2, array('style'=>'width:100%;', 'value'=>$mixevalQuestion['title']))."<br>"
				  ."</td></tr></table></td><td/>";
			echo "</tr><tr class=tablecell align=center>";
      echo $html->hidden('Mixeval/question_type'.$pos, array('value'=>'S'));
      
			//for loop to display the criteria comment cells for each LOM
			for($j=1; $j<=$scale_default; $j++){
				isset($mixevalQuestion['multiplier']) ? $multiplier = $mixevalQuestion['multiplier'] : $multiplier = 1;

				if( $zero_mark == "on" ){
					$mark_value = round( ($multiplier/($scale_default-1)*($j-1)) , 2);
				}
				else{
					$mark_value = round( ($multiplier/$scale_default*$j) , 2);
				}
				echo "<td><table border=0 width=95% cellpadding=2><tr><td>Descriptor</td></tr><tr><td>".$html->areaTag('Mixeval/criteria_comment_'
					 .$i.'_'.$j,'',1, array('style'=>'width:100%;', 'value'=>$descriptor_des[$j]))."</td></tr>";
			  echo "<tr><td align='center'><input type='radio' name='criteria_radio_".$i."_".$j."' class='input' size='3' >"."</td></tr>";
			  echo "<tr><td align=center>Mark: "."<input type=text name=criteria_mark_".$i."_".$j." class=input size=3 readonly value=".$mark_value.">"."</td></tr>";
			  echo "</table></td>";
			}
			
			echo '<td>';
			echo '<select name=criteria_weight_'.$i.' style="width:50px;" onchange="calculateMarks(\''.$scale_default.'\',\''.$question_default.'\',\''.$zero_mark.'\')">';
			for ($x = 1; $x <= 15; $x++) {
  			echo '<option value="'.$x.'" ';
  			if ($x == $multiplier) {
  			  echo 'selected';
  			}
  			echo ' >'.$x.'</option>';
  		}
			echo '</select>';
			echo '</td>';
			
			echo "</tr>";
			$pos++;
		}
		echo "<tr class=tableheader2>";
		echo "<td colspan=".($scale_default)." align=right>Total Marks: </td>";
		echo "<td align=center> <input type='text' name='total_marks' id='total' class='input' value='".$total_mark."' size='5%' readonly></td>";
		echo "</tr>";
		?>
  <tr>
    <td colspan="3" align="center">&nbsp;</td>
    </tr>		
  </table>
  <table width="95%" border="0" align="center" cellpadding="4" cellspacing="2">
    <tr class="tableheader" align=center>
			<td align="left">Section Two: &nbsp;Comments (No Weight on this Section)</td>
		</tr>
 	<?php	//for loop to display the criteria rows
		for($i=1; $i<=$prefill_question_max; $i++){ 
		  		  //Get Mixeval Question
		  isset($questions[$pos])? $mixevalQuestion = $questions[$pos] : $mixevalQuestion = null;
		  $this->controller->Output->br2nl($mixevalQuestion);	
  ?>
			<tr class=tablecell align=center>
  			<td class=tableheader2 valign=top colspan='".$scale_default."'>
  			  <table border=0 width=95% cellpadding=2>
  			    <tr><td width='15%'>Question <?=$pos?>:</td>
  			        <td width='85%' align='left'> Question Prompt:
  			          <?php echo	$html->input('Mixeval/title'.$pos, array('style'=>'width:100%;', 'value'=>isset($mixevalQuestion['title'])? $mixevalQuestion['title'] : '')) ?> <br>
  			          <?php echo $html->hidden('Mixeval/question_type'.$pos, array('value'=>'T'));?>
  				      </td>
  				    </tr><tr>
                <td/>
                <td>Mandatory?:
                  <?php 
                   $checkRequired = 'CHECKED';
                   $checkNo = '';
                   if (isset($mixevalQuestion['required']) && $mixevalQuestion['required']==0) {
                     $checkRequired = '';
                     $checkNo = 'CHECKED';
                   }?>
          		    <input type=radio name="data[Mixeval][text_require<?=$pos?>]" id="student_comments" value="1" <?php echo $checkRequired?> > - Yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          		    <input type=radio name="data[Mixeval][text_require<?=$pos?>]" id="student_comments" value="0" <?php echo $checkNo ?> > - No<br>
                </td>  				      
  				  </tr>
  			  </table>
  		 </td>
		  </tr>
		  <tr class=tablecell align=center>
			  <td>
			    <table border=0 width=95% cellpadding=2>
			      <tr>
			        <td colspan=2>Instructions:</td>
            </tr>
            <tr><td colspan=2>
                  <?php echo $html->areaTag('Mixeval/text_instruction'.$pos,'',2, array('style'=>'width:100%;', 'value'=>isset($mixevalQuestion['instructions'])? $mixevalQuestion['instructions'] :'')) ?>
            </td></tr>
            <tr><td width='15%'>Select Student's Answer Option: </td>
                <td width='85%' align='left'>
                  <?php 
                   $responseLickert = 'CHECKED';
                   $responseText = '';
                   if (isset($mixevalQuestion['response_type']) && $mixevalQuestion['response_type']=='L') {
                   $responseLickert = '';
                   $responseText = 'CHECKED';
                   }?>                  
          		    <input type=radio name="data[Mixeval][response_type<?=$pos?>]" id="comment_type" value="S" <?=$responseLickert?>  > Single line of text input box<br>
          		    <input type=radio name="data[Mixeval][response_type<?=$pos?>]" id="comment_type" value="L" <?=$responseText?> > Multiple lines of text input box<br>
                </td></tr>
			 </table></td>
			</tr>
<?php			$pos++;
		}
		?>
<?php echo $html->hidden('Mixeval/total_question', array('value'=>$pos));?>		
  <tr>
  		<td colspan="3" align="center">
  		  <?php if (empty($params['data']['Mixeval']['id'])) {
  		      echo $html->submit('Add Mix Evaluation'); 
  		    } else {
  		      echo $html->submit('Edit Mix Evaluation'); 
  		    }?>
		<input type=button name="Back" value="Back" onClick="parent.location='<?php echo $this->webroot.$this->themeWeb.$this->params['controller']; ?>'">
		</td>
    </tr>		
  </table>  
</form>
<!-- elements::ajax_rubric_preview end -->